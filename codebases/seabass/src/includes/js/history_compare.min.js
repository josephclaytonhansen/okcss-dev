$(".lightbox-modal-close").on("click",(function(){$(".lightbox-modal").addClass("hidden"),$("#editor-grid").css("pointer-events","auto"),$("#editor-grid").css("opacity","1")}));let ll=0,rr=1,mostRecent=null,secondMostRecent=null,left_time_d=null,right_time_d=null;import{savePost}from"./postFunctions.js";function populateHistory(e=0,t=1){let r=$("#history-storage").text();r=r.split(',{"time');let o=-1;r.forEach((e=>{o+=1,e.startsWith('{"time')||(r[o]='{"time'+e)})),r.sort((function(e,t){let r=JSON.parse(e).time;return JSON.parse(t).time-r})),mostRecent=r[e],secondMostRecent=r[t];let l=JSON.parse(secondMostRecent).time;left_time_d=l,l=new Date(l),l=l.toLocaleDateString()+" "+l.toLocaleTimeString();let a=JSON.parse(mostRecent).time;a=new Date(a),a=a.toLocaleDateString()+" "+a.toLocaleTimeString(),$("#left-time").text(l),$("#right-time").text(a);let s=JSON.parse(secondMostRecent).blocks,i="",c="";JSON.parse(mostRecent).blocks.forEach((e=>{if("paragraph"==e.type)i+="<p>"+e.data.text+"</p>";else if("header"==e.type){let t=e.data.level;i+="<h"+t+">"+e.data.text+"</h"+t+">"}else i+="<p>"+e.type+" - "+e.data.text+"</p>"})),s.forEach((e=>{if("paragraph"==e.type)c+="<p>"+e.data.text+"</p>";else if("header"==e.type){let t=e.data.level;c+="<h"+t+">"+e.data.text+"</h"+t+">"}else c+="<p>"+e.type+" - "+e.data.text+"</p>"}));let n=i.replace(/href=".*?"/g,""),d=c.replace(/href=".*?"/g,"");["canvas","svg","iframe","script","pre","code","form"].forEach((e=>{let t=new RegExp("<"+e+".*?(/>|</"+e+">)","gi");n=n.replace(t,""),d=d.replace(t,"")})),n=n.replace(/(?!href=".*?)(\.[a-zA-Z0-9]{2,5})/g,"file"),d=d.replace(/(?!href=".*?)(\.[a-zA-Z0-9]{2,5})/g,"file"),$("#r-right").html(n),$("#r-left").html(d)}populateHistory(ll,rr),$("#left-arrow").on("click",(function(){try{let e=$("#history-count").text().split(" ")[1];ll<e&&($("#left-arrow").removeClass("disabled"),ll+=1,rr+=1,populateHistory(ll,rr)),ll==e&&$("#left-arrow").addClass("disabled"),$("#right-arrow").removeClass("disabled")}catch(e){$("#left-arrow").addClass("disabled")}$("#right-arrow").removeClass("disabled")})),$("#right-arrow").on("click",(function(){try{rr>0&&($("#right-arrow").removeClass("disabled"),ll-=1,rr-=1,populateHistory(ll,rr)),0==rr&&($("#right-arrow").addClass("disabled"),$("#left-arrow").removeClass("disabled"))}catch{$("#right-arrow").addClass("disabled"),$("#left-arrow").removeClass("disabled")}})),$("#restore-right").on("click",(function(){let e=JSON.stringify(right_time_d);mostRecent=JSON.parse(mostRecent),mostRecent.time=e,mostRecent=JSON.stringify(mostRecent),savePost(mostRecent),window.location.reload()})),$("#restore-left").on("click",(function(){let e=JSON.stringify(left_time_d);secondMostRecent=JSON.parse(secondMostRecent),secondMostRecent.time=e,secondMostRecent=JSON.stringify(secondMostRecent),savePost(secondMostRecent),window.location.reload()}));