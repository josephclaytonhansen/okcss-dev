import mongoose from"mongoose";import dotenv from"dotenv";dotenv.config();const MONGO_STRING=process.env.MONGO_STRING,connectWithRetry=()=>mongoose.connect(MONGO_STRING,{useNewUrlParser:!0,useUnifiedTopology:!0,dbName:"weasel-backend-dev",keepAlive:!0,keepAliveInitialDelay:3e5,retryReads:!0,retryWrites:!0}).catch((e=>{setTimeout(connectWithRetry,1e3)}));connectWithRetry();const db=mongoose.connection;db.on("error",(e=>{mongoose.disconnect()})),db.on("connected",(()=>{})),db.on("disconnected",(()=>{connectWithRetry()})),db.ObjectId=mongoose.Types.ObjectId,db.sessionStorage={sessions:{},get:function(e,o){o(null,this.sessions[e])},set:function(e,o,n){this.sessions[e]=o,n(null,o)},destroy:function(e,o){delete this.sessions[e],o(null)}};export default db;