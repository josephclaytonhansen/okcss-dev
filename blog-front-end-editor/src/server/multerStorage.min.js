import dotenv from"dotenv";import multer from"multer";import{GridFsStorage}from"multer-gridfs-storage";import crypto from"crypto";dotenv.config();const storage=new GridFsStorage({url:process.env.MONGO_STRING,file:(r,e)=>new Promise(((r,o)=>{crypto.randomBytes(16,((t,i)=>{if(t)return o(t);const a=e.originalname;r({filename:a,bucketName:"uploads"})}))}))}),imageFilter=(r,e,o)=>{if(!e.originalname.match(/\.(jpg|jpeg|png|gif)$/))return r.fileValidationError="Invalid image format. Only jpeg, jpg, png and gif images are allowed.",o(new Error("Invalid image format"),!1);o(null,!0)},upload=multer({storage:storage,fileFilter:imageFilter});export default upload;