$(".lightbox-modal-close").on("click",(function(){$(".lightbox-modal").addClass("hidden"),$("#editor-grid").css("pointer-events","auto"),$("#editor-grid").css("opacity","1")}));let ll=0,rr=1,mostRecent=null,secondMostRecent=null,left_time_d=null,right_time_d=null;import{savePost}from"./postFunctions.js";function populateHistory(e=0,t=1){let r=$("#history-storage").text();r=r.split(',{"time');let l=-1;r.forEach((e=>{l+=1,e.startsWith('{"time')||(r[l]='{"time'+e)})),r.sort((function(e,t){let r=JSON.parse(e).time;return JSON.parse(t).time-r})),mostRecent=r[e],secondMostRecent=r[t];let o=JSON.parse(secondMostRecent).time;left_time_d=o,o=new Date(o),o=o.toLocaleDateString()+" "+o.toLocaleTimeString();let s=JSON.parse(mostRecent).time;s=new Date(s),s=s.toLocaleDateString()+" "+s.toLocaleTimeString(),$("#left-time").text(o),$("#right-time").text(s);let a=JSON.parse(secondMostRecent).blocks,i="",c="";JSON.parse(mostRecent).blocks.forEach((e=>{if("paragraph"==e.type)i+="<p>"+e.data.text+"</p>";else if("header"==e.type){let t=e.data.level;i+="<h"+t+">"+e.data.text+"</h"+t+">"}else i+="<p>"+e.type+" - "+e.data.text+"</p>"})),a.forEach((e=>{if("paragraph"==e.type)c+="<p>"+e.data.text+"</p>";else if("header"==e.type){let t=e.data.level;c+="<h"+t+">"+e.data.text+"</h"+t+">"}else c+="<p>"+e.type+" - "+e.data.text+"</p>"}));let n=i.replace(/href=".*?"/g,"");n=n.replace(/<script>.*?<\/script>/g,""),n=n.replace(/<iframe>.*?<\/iframe>/g,"");let d=c.replace(/href=".*?"/g,"");d=d.replace(/<script>.*?<\/script>/g,""),d=d.replace(/<iframe>.*?<\/iframe>/g,""),$("#r-right").html(n),$("#r-left").html(d)}populateHistory(ll,rr),$("#left-arrow").on("click",(function(){try{let e=$("#history-count").text().split(" ")[1];ll<e&&($("#left-arrow").removeClass("disabled"),ll+=1,rr+=1,populateHistory(ll,rr)),ll==e&&$("#left-arrow").addClass("disabled"),$("#right-arrow").removeClass("disabled")}catch(e){$("#left-arrow").addClass("disabled")}$("#right-arrow").removeClass("disabled")})),$("#right-arrow").on("click",(function(){try{rr>0&&($("#right-arrow").removeClass("disabled"),ll-=1,rr-=1,populateHistory(ll,rr)),0==rr&&($("#right-arrow").addClass("disabled"),$("#left-arrow").removeClass("disabled"))}catch{$("#right-arrow").addClass("disabled"),$("#left-arrow").removeClass("disabled")}})),$("#restore-right").on("click",(function(){let e=JSON.stringify(right_time_d);mostRecent=JSON.parse(mostRecent),mostRecent.time=e,mostRecent=JSON.stringify(mostRecent),savePost(mostRecent),window.location.reload()})),$("#restore-left").on("click",(function(){let e=JSON.stringify(left_time_d);secondMostRecent=JSON.parse(secondMostRecent),secondMostRecent.time=e,secondMostRecent=JSON.stringify(secondMostRecent),savePost(secondMostRecent),window.location.reload()}));