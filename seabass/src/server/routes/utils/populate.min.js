import axios from"axios";import User from"../../models/userModel.min.js";import Post from"../../models/postModel.min.js";import fs from"fs";const populate=async(s,e)=>{let a=s.session.passport.user,t=null;if(s.session.user)t=s.session.user;else{let e=await User.findById(a).then((s=>s));s.session.user=e}let o=null,i=null;s.session.categories?(o=s.session.categories,i=o.map((s=>({name:s.name,id:s._id})))):(o=await axios.get("http://178.128.224.147:5920/category/"),s.session.categories=o.data,i=o.data.map((s=>({name:s.name,id:s._id}))));let n=null;s.session.posts?n=s.session.posts:(n=await axios.get("http://178.128.224.147:5920/post/"),s.session.posts=n.data);let l=null;s.session.pages?l=s.session.pages:(l=await axios.get("http://178.128.224.147:5920/page/"),s.session.pages=l.data);let r=null;s.session.comments?r=s.session.comments:(r=await axios.get("http://178.128.224.147:5920/comment/"),s.session.comments=r.data);let p=null,m=null;return s.session.users?(p=s.session.users,m=p.map((s=>({name:s.display_name,id:s._id})))):(p=await axios.get("http://178.128.224.147:5920/user/"),s.session.users=p.data,m=p.data.map((s=>({name:s.display_name,id:s._id})))),{user:t,categories:o,all_categories:i,posts:n,pages:l,comments:r,users:p,all_authors:m}},populateNew=async(s,e)=>{let a=s.session.passport.user,t=null;if(s.session.user)t=s.session.user;else{let e=await User.findById(a).then((s=>s));s.session.user=e}let o=null,i=null;s.session.categories?(o=s.session.categories,i=o.map((s=>({name:s.name,id:s._id})))):(o=await axios.get("http://178.128.224.147:5920/category/"),s.session.categories=o.data,i=o.data.map((s=>({name:s.name,id:s._id}))));let n=null,l=null;return s.session.users?(n=s.session.users,l=n.map((s=>({name:s.display_name,id:s._id})))):(n=await axios.get("http://178.128.224.147:5920/user/"),s.session.users=n.data,l=n.data.map((s=>({name:s.display_name,id:s._id})))),{user:t,categories:o,all_categories:i,users:n,all_authors:l}};export{populate,populateNew};