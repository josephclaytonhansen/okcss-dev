const getUserPermissions=async(s,e)=>(await s.findById(e)).permissions,authMiddleware=(s,e)=>{if(!s.session.passport)return!1;if(s.session.permissions){if("worm"!==s.session.permissions)return!0}else getUserPermissions(e,s.session.passport.user).then((e=>{if(s.session.permissions=e,"worm"!==s.session.permissions)return!0}));return!1};export default authMiddleware;