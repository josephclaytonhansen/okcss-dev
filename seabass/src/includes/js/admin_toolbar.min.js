import{savePostCallback,savePost,publishPost,unpublishPost}from"/postFunctions.js";function showDropdown(e,o,t,d,s,n,l,a){let c=e.parentElement.parentElement.getBoundingClientRect();$(o).addClass("hidden"),$(t).removeClass("hidden");let i=document.createElement("div");i.classList.add("dropdown"),i.id=a,i.style.top=c.bottom-l+"px",i.style.left=c.left-2+"px",i.style.width=c.width+n+"px",i.style.position="absolute",i.style.zIndex="800",i.style.backgroundColor="#404040",document.body.appendChild(i),"account"==a?d.forEach((e=>{let o=document.createElement("div");o.classList.add("dropdown-item"),o.addEventListener("click",(o=>{let t=s[d.indexOf(e)];t.startsWith("/")?document.location.href=t:window[t]()})),o.innerHTML=e,i.appendChild(o)})):scheduleDropdown(i)}function scheduleDropdown(e){let o=e,t=document.createElement("input");t.style.width="100%",t.id="calendar",t.type="date";let d=document.createElement("button");d.id="submit",d.onclick=e=>{let o=$("#calendar").val(),t=new URL(window.location.href),d=t.href.indexOf("post/"),s=t.href.slice(d+5);o=new Date(o),$.ajax({method:"POST",url:"/post/update/"+s,data:{scheduled_date:o,status:"scheduled"},success:()=>{$.ajax({method:"GET",url:"/refresh-session",success:()=>{window.location.reload()}})},error:e=>{}})},$("#submit").on("click",(e=>{let o=$("#calendar").val(),t=new URL(window.location.href),d=t.href.indexOf("post/"),s=t.href.slice(d+5);o=new Date(o),$.ajax({method:"POST",url:"/post/update/"+s,data:{scheduled_date:o,status:"scheduled"},success:()=>{$.ajax({method:"GET",url:"/refresh-session",success:()=>{window.location.reload()}})},error:e=>{}})})),d.innerHTML="Submit",d.classList.add("ocean"),d.classList.add("fullwidth"),o.appendChild(t),o.appendChild(d)}$("#user-dropdown").on("click",(e=>{e.stopPropagation(),showDropdown(e.target,"#user-dropdown","#dropdown-close",["Account settings","Log out"],["/account","/logout"],2,14,"account")})),$("#dropdown-close").on("click",(e=>{e.stopPropagation(),$("#dropdown-close").addClass("hidden"),$("#user-dropdown").removeClass("hidden"),$(".dropdown").remove()})),$("#save").on("click",(e=>{savePost(sessionStorage.getItem("current-blog-data-raw"))})),$("#publish").on("click",(e=>{publishPost()})),$("#unpublish").on("click",(e=>{unpublishPost()})),$("#schedule").on("click",(e=>{e.stopPropagation(),0==$("#schedule-dropdown").length?showDropdown(e.target,"#schedule","#schedule",[],[],100,0,"schedule-dropdown"):$("#schedule-dropdown").remove()}));