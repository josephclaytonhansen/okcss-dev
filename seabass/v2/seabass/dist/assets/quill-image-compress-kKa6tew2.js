import{g as L}from"./fast-diff-OpWFUizR.js";var P={exports:{}};(function(C,F){(function(I,m){C.exports=m()})(window,function(){return function(I){var m={};function y(i){if(m[i])return m[i].exports;var c=m[i]={i,l:!1,exports:{}};return I[i].call(c.exports,c,c.exports,y),c.l=!0,c.exports}return y.m=I,y.c=m,y.d=function(i,c,v){y.o(i,c)||Object.defineProperty(i,c,{enumerable:!0,get:v})},y.r=function(i){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},y.t=function(i,c){if(1&c&&(i=y(i)),8&c||4&c&&typeof i=="object"&&i&&i.__esModule)return i;var v=Object.create(null);if(y.r(v),Object.defineProperty(v,"default",{enumerable:!0,value:i}),2&c&&typeof i!="string")for(var w in i)y.d(v,w,(function(b){return i[b]}).bind(null,w));return v},y.n=function(i){var c=i&&i.__esModule?function(){return i.default}:function(){return i};return y.d(c,"a",c),c},y.o=function(i,c){return Object.prototype.hasOwnProperty.call(i,c)},y.p="/dist/",y(y.s=1)}([function(I,m,y){var i=this&&this.__awaiter||function(v,w,b,d){return new(b||(b=Promise))(function(o,g){function n(t){try{r(d.next(t))}catch(e){g(e)}}function a(t){try{r(d.throw(t))}catch(e){g(e)}}function r(t){var e;t.done?o(t.value):(e=t.value,e instanceof b?e:new b(function(u){u(e)})).then(n,a)}r((d=d.apply(v,w||[])).next())})},c=this&&this.__generator||function(v,w){var b,d,o,g,n={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return g={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(g[Symbol.iterator]=function(){return this}),g;function a(r){return function(t){return function(e){if(b)throw new TypeError("Generator is already executing.");for(;g&&(g=0,e[0]&&(n=0)),n;)try{if(b=1,d&&(o=2&e[0]?d.return:e[0]?d.throw||((o=d.return)&&o.call(d),0):d.next)&&!(o=o.call(d,e[1])).done)return o;switch(d=0,o&&(e=[2&e[0],o.value]),e[0]){case 0:case 1:o=e;break;case 4:return n.label++,{value:e[1],done:!1};case 5:n.label++,d=e[1],e=[0];continue;case 7:e=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!((o=o.length>0&&o[o.length-1])||e[0]!==6&&e[0]!==2)){n=0;continue}if(e[0]===3&&(!o||e[1]>o[0]&&e[1]<o[3])){n.label=e[1];break}if(e[0]===6&&n.label<o[1]){n.label=o[1],o=e;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(e);break}o[2]&&n.ops.pop(),n.trys.pop();continue}e=w.call(v,n)}catch(u){e=[6,u],d=0}finally{b=o=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([r,t])}}};Object.defineProperty(m,"__esModule",{value:!0}),m.file2b64=void 0,m.file2b64=function(v){return i(this,void 0,void 0,function(){var w,b;return c(this,function(d){return w=new FileReader,b=new Promise(function(o,g){w.addEventListener("load",function(){var n,a=(n=w.result)===null||n===void 0?void 0:n.toString();a?o(a):g("could not convert file to base64")},!1)}),w.readAsDataURL(v),[2,b]})})}},function(I,m,y){var i=this&&this.__awaiter||function(n,a,r,t){return new(r||(r=Promise))(function(e,u){function l(s){try{p(t.next(s))}catch(f){u(f)}}function h(s){try{p(t.throw(s))}catch(f){u(f)}}function p(s){var f;s.done?e(s.value):(f=s.value,f instanceof r?f:new r(function(x){x(f)})).then(l,h)}p((t=t.apply(n,a||[])).next())})},c=this&&this.__generator||function(n,a){var r,t,e,u,l={label:0,sent:function(){if(1&e[0])throw e[1];return e[1]},trys:[],ops:[]};return u={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function h(p){return function(s){return function(f){if(r)throw new TypeError("Generator is already executing.");for(;u&&(u=0,f[0]&&(l=0)),l;)try{if(r=1,t&&(e=2&f[0]?t.return:f[0]?t.throw||((e=t.return)&&e.call(t),0):t.next)&&!(e=e.call(t,f[1])).done)return e;switch(t=0,e&&(f=[2&f[0],e.value]),f[0]){case 0:case 1:e=f;break;case 4:return l.label++,{value:f[1],done:!1};case 5:l.label++,t=f[1],f=[0];continue;case 7:f=l.ops.pop(),l.trys.pop();continue;default:if(e=l.trys,!((e=e.length>0&&e[e.length-1])||f[0]!==6&&f[0]!==2)){l=0;continue}if(f[0]===3&&(!e||f[1]>e[0]&&f[1]<e[3])){l.label=f[1];break}if(f[0]===6&&l.label<e[1]){l.label=e[1],e=f;break}if(e&&l.label<e[2]){l.label=e[2],l.ops.push(f);break}e[2]&&l.ops.pop(),l.trys.pop();continue}f=a.call(n,l)}catch(x){f=[6,x],t=0}finally{r=e=0}if(5&f[0])throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}([p,s])}}};Object.defineProperty(m,"__esModule",{value:!0}),m.imageCompressor=void 0;var v=y(2),w=y(3),b=y(0),d=y(4),o=y(5),g=function(){function n(a,r){var t=this;this.quill=a,this.options=r||{};var e=!!r.debug,u=!!r.suppressErrorLogging;this.Logger=new o.ConsoleLogger(e,u),(0,w.warnAboutOptions)(r,this.Logger),this.imageDrop=new v.ImageDrop(a,function(h){return i(t,void 0,void 0,function(){var p;return c(this,function(s){switch(s.label){case 0:return this.Logger.log("onImageDrop",{dataUrl:h}),[4,this.downscaleImageFromUrl(h)];case 1:return p=s.sent(),this.insertToEditor(p,n.b64toBlob(p)),[2]}})})},this.Logger),this.Logger.log("fileChanged",{options:r,quill:a,debug:e});var l=this.quill.getModule("toolbar");l?l.addHandler("image",function(){return t.selectLocalImage()}):this.Logger.error("Quill toolbar module not found! need { toolbar: // options } in Quill.modules for image icon to sit in")}return n.b64toBlob=function(a){for(var r=atob(a.split(",")[1]),t=a.slice(5).split(";")[0],e=new ArrayBuffer(r.length),u=new Uint8Array(e),l=0;l<r.length;l++)u[l]=r.charCodeAt(l);return new Blob([e],{type:t})},n.prototype.selectLocalImage=function(a){var r=this;this.range=this.quill.getSelection(),this.fileHolder=document.createElement("input"),this.fileHolder.setAttribute("type","file"),this.fileHolder.setAttribute("accept","image/*"),this.fileHolder.setAttribute("style","visibility:hidden"),this.fileHolder.onchange=function(){return r.fileChanged().then(function(){return a&&a()})},document.body.appendChild(this.fileHolder),this.fileHolder.click(),window.requestAnimationFrame(function(){r.fileHolder&&document.body.removeChild(r.fileHolder)})},n.prototype.fileChanged=function(a){var r;return i(this,void 0,void 0,function(){var t,e,u,l;return c(this,function(h){switch(h.label){case 0:return(t=a||((r=this.fileHolder)===null||r===void 0?void 0:r.files))&&t.length?(e=t[0],this.Logger.log("fileChanged",{file:e}),e?[4,(0,b.file2b64)(e)]:[2]):[2];case 1:return u=h.sent(),[4,this.downscaleImageFromUrl(u)];case 2:return l=h.sent(),this.insertToEditor(l,n.b64toBlob(l)),[2]}})})},n.prototype.downscaleImageFromUrl=function(a){return i(this,void 0,void 0,function(){var r;return c(this,function(t){switch(t.label){case 0:return[4,(0,d.downscaleImage)(this.Logger,a,this.options.maxWidth,this.options.maxHeight,this.options.imageType,this.options.keepImageTypes,this.options.ignoreImageTypes,this.options.quality)];case 1:return r=t.sent(),this.Logger.log("downscaleImageFromUrl",{dataUrl:a,dataUrlCompressed:r}),[2,r]}})})},n.prototype.insertToEditor=function(a,r){if(this.options.insertIntoEditor)this.options.insertIntoEditor(a,r,this.quill);else{this.Logger.log("insertToEditor",{url:a}),this.range=this.quill.getSelection();var t=this.range;if(!t)return;this.logFileSize(a),this.quill.insertEmbed(t.index,"image","".concat(a),"user"),t.index++,this.quill.setSelection(t,"api")}},n.prototype.logFileSize=function(a){var r=(Math.round(3*(a.length-22)/4)/1024).toFixed(0);this.Logger.log("estimated img size: "+r+" kb")},n}();m.imageCompressor=g,window.imageCompressor=g,m.default=g},function(I,m,y){var i=this&&this.__awaiter||function(g,n,a,r){return new(a||(a=Promise))(function(t,e){function u(p){try{h(r.next(p))}catch(s){e(s)}}function l(p){try{h(r.throw(p))}catch(s){e(s)}}function h(p){var s;p.done?t(p.value):(s=p.value,s instanceof a?s:new a(function(f){f(s)})).then(u,l)}h((r=r.apply(g,n||[])).next())})},c=this&&this.__generator||function(g,n){var a,r,t,e,u={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return e={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(e[Symbol.iterator]=function(){return this}),e;function l(h){return function(p){return function(s){if(a)throw new TypeError("Generator is already executing.");for(;e&&(e=0,s[0]&&(u=0)),u;)try{if(a=1,r&&(t=2&s[0]?r.return:s[0]?r.throw||((t=r.return)&&t.call(r),0):r.next)&&!(t=t.call(r,s[1])).done)return t;switch(r=0,t&&(s=[2&s[0],t.value]),s[0]){case 0:case 1:t=s;break;case 4:return u.label++,{value:s[1],done:!1};case 5:u.label++,r=s[1],s=[0];continue;case 7:s=u.ops.pop(),u.trys.pop();continue;default:if(t=u.trys,!((t=t.length>0&&t[t.length-1])||s[0]!==6&&s[0]!==2)){u=0;continue}if(s[0]===3&&(!t||s[1]>t[0]&&s[1]<t[3])){u.label=s[1];break}if(s[0]===6&&u.label<t[1]){u.label=t[1],t=s;break}if(t&&u.label<t[2]){u.label=t[2],u.ops.push(s);break}t[2]&&u.ops.pop(),u.trys.pop();continue}s=n.call(g,u)}catch(f){s=[6,f],r=0}finally{a=t=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([h,p])}}};Object.defineProperty(m,"__esModule",{value:!0}),m.ImageDrop=void 0;var v=y(0),w=function(){function g(n,a,r){var t=this;this.quill=n,this.onNewDataUrl=a,this.logger=r,this.quill.root.addEventListener("drop",function(e){return t.handleDrop(e)},!1),this.quill.root.addEventListener("paste",function(e){return t.handlePaste(e)},!1)}return g.prototype.handleDrop=function(n){return i(this,void 0,void 0,function(){var a,r,t,e,u,l,h;return c(this,function(p){switch(p.label){case 0:return n.preventDefault(),document.caretRangeFromPoint&&(a=document.getSelection(),r=document.caretRangeFromPoint(n.clientX,n.clientY),a&&r&&a.setBaseAndExtent(r.startContainer,r.startOffset,r.startContainer,r.startOffset)),[4,d(n)];case 1:return t=p.sent(),e=Array.from(t||[]).filter(function(s){return o(s.type)}),(u=e==null?void 0:e[0])?[4,(0,v.file2b64)(u)]:[3,3];case 2:return h=p.sent(),this.logger.log("handleNewImageFiles",{evt:n,files:t,filesFiltered:e,firstImage:u,base64ImageSrc:h}),this.onNewDataUrl(h),[2];case 3:return[4,b(n)];case 4:return(l=p.sent())?[4,(0,v.file2b64)(l)]:[3,6];case 5:return h=p.sent(),this.logger.log("handleNewImageFiles",{evt:n,blob:l,base64ImageSrc:h}),this.onNewDataUrl(h),[2];case 6:return[2]}})})},g.prototype.handlePaste=function(n){var a,r;return i(this,void 0,void 0,function(){var t,e,u,l;return c(this,function(h){switch(h.label){case 0:return t=Array.from(((a=n==null?void 0:n.clipboardData)===null||a===void 0?void 0:a.items)||[]),this.logger.log("handlePaste",{files:t,evt:n}),e=t.filter(function(p){return o(p.type)}),this.logger.log("handlePaste",{images:e,evt:n}),e.length?e.filter(function(p){return p.type!=="text/html"}).length?(n.preventDefault(),(u=(r=e.pop())===null||r===void 0?void 0:r.getAsFile())?[4,(0,v.file2b64)(u)]:[2]):(this.logger.log("handlePaste also detected html"),[2]):[2];case 1:return l=h.sent(),this.logger.log("handleNewImageFiles",{base64ImageSrc:l}),this.onNewDataUrl(l),[2]}})})},g}();function b(g){var n;return i(this,void 0,void 0,function(){var a;return c(this,function(r){switch(r.label){case 0:return(a=(n=g.dataTransfer)===null||n===void 0?void 0:n.getData("URL"))?[4,fetch(a)]:[3,3];case 1:return[4,r.sent().blob()];case 2:return[2,r.sent()];case 3:return[2]}})})}function d(g){var n;return i(this,void 0,void 0,function(){return c(this,function(a){return[2,(n=g==null?void 0:g.dataTransfer)===null||n===void 0?void 0:n.files]})})}function o(g){return!!g.match(/^image\/(gif|jpe?g|a?png|svg|webp|bmp)/i)}m.ImageDrop=w},function(I,m,y){Object.defineProperty(m,"__esModule",{value:!0}),m.warnAboutOptions=void 0,m.warnAboutOptions=function(i,c){i.maxWidth=i.maxWidth||1e3,i.maxHeight=i.maxHeight||1e3,i.maxWidth&&typeof i.maxWidth!="number"&&(c.warn(`[config error] 'maxWidth' is required to be a "number" (in pixels), 
received: `.concat(i.maxWidth,`
-> using default 1000`)),i.maxWidth=1e3),i.maxHeight&&typeof i.maxHeight!="number"&&(c.warn(`[config error] 'maxHeight' is required to be a "number" (in pixels), 
received: `.concat(i.maxHeight,`
-> using default 1000`)),i.maxHeight=1e3),i.quality&&typeof i.quality!="number"&&(c.warn(`quill.imageCompressor: [config error] 'quality' is required to be a "number", 
received: `.concat(i.quality,`
-> using default 0.7`)),i.quality=.7),!i.imageType||typeof i.imageType=="string"&&i.imageType.startsWith("image/")||(c.warn(`quill.imageCompressor: [config error] 'imageType' is required be in the form of "image/png" or "image/jpeg" etc ..., 
received: `.concat(i.imageType,`
-> using default image/jpeg`)),i.imageType="image/jpeg"),i.keepImageTypes||(i.keepImageTypes=[]),i.keepImageTypes&&!Array.isArray(i.keepImageTypes)&&(c.warn(`quill.imageCompressor: [config error] 'keepImageTypes' is required to be a "array", received: `.concat(i.keepImageTypes," -> using default []")),i.keepImageTypes=[]),i.ignoreImageTypes||(i.ignoreImageTypes=[]),i.ignoreImageTypes&&!Array.isArray(i.ignoreImageTypes)&&(c.warn(`quill.imageCompressor: [config error] 'ignoreImageTypes' is required to be a "array", received: `.concat(i.ignoreImageTypes," -> using default []")),i.ignoreImageTypes=[]),i.insertIntoEditor&&typeof i.insertIntoEditor!="function"&&(c.warn(`quill.imageCompressor: [config error] 'insertIntoEditor' is required to be a "function", received: `.concat(i.insertIntoEditor," -> using default undefined")),i.insertIntoEditor=void 0)}},function(I,m,y){var i=this&&this.__awaiter||function(v,w,b,d){return new(b||(b=Promise))(function(o,g){function n(t){try{r(d.next(t))}catch(e){g(e)}}function a(t){try{r(d.throw(t))}catch(e){g(e)}}function r(t){var e;t.done?o(t.value):(e=t.value,e instanceof b?e:new b(function(u){u(e)})).then(n,a)}r((d=d.apply(v,w||[])).next())})},c=this&&this.__generator||function(v,w){var b,d,o,g,n={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return g={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(g[Symbol.iterator]=function(){return this}),g;function a(r){return function(t){return function(e){if(b)throw new TypeError("Generator is already executing.");for(;g&&(g=0,e[0]&&(n=0)),n;)try{if(b=1,d&&(o=2&e[0]?d.return:e[0]?d.throw||((o=d.return)&&o.call(d),0):d.next)&&!(o=o.call(d,e[1])).done)return o;switch(d=0,o&&(e=[2&e[0],o.value]),e[0]){case 0:case 1:o=e;break;case 4:return n.label++,{value:e[1],done:!1};case 5:n.label++,d=e[1],e=[0];continue;case 7:e=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!((o=o.length>0&&o[o.length-1])||e[0]!==6&&e[0]!==2)){n=0;continue}if(e[0]===3&&(!o||e[1]>o[0]&&e[1]<o[3])){n.label=e[1];break}if(e[0]===6&&n.label<o[1]){n.label=o[1],o=e;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(e);break}o[2]&&n.ops.pop(),n.trys.pop();continue}e=w.call(v,n)}catch(u){e=[6,u],d=0}finally{b=o=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([r,t])}}};Object.defineProperty(m,"__esModule",{value:!0}),m.downscaleImage=void 0,m.downscaleImage=function(v,w,b,d,o,g,n,a){return i(this,void 0,void 0,function(){var r,t,e,u,l,h,p,s;return c(this,function(f){switch(f.label){case 0:return r=w.split(";")[0].split(":")[1],o=o||"image/jpeg",a=a||.7,(t=new Image).src=w,[4,new Promise(function(x){t.onload=function(){x()}})];case 1:return f.sent(),e=function(x,_,q,T){if(q&&T&&x<=q&&_<=T)return[x,_];if(q&&x>q){var S=q,E=Math.floor(_/x*S);if(T&&E>T){var k=T;return[Math.floor(x/_*k),k]}return[S,E]}return T&&_>T?(E=T,[S=Math.floor(x/_*E),E]):[_,x]}(t.width,t.height,b,d),u=e[0],l=e[1],(h=document.createElement("canvas")).width=u,h.height=l,p=h.getContext("2d"),o==="image/jpeg"&&(p.fillStyle="#FFFFFF",p.fillRect(0,0,t.width,t.height)),n!=null&&n.includes(r)?[2,w]:(g!=null&&g.includes(r)&&(o=r),p.drawImage(t,0,0,u,l),s=h.toDataURL(o,a),v.log("downscaling image...",{args:{dataUrl:w,maxWidth:b,maxHeight:d,imageType:o,ignoreImageTypes:n,keepImageTypes:g,imageQuality:a},newHeight:l,newWidth:u}),[2,s])}})})}},function(I,m,y){Object.defineProperty(m,"__esModule",{value:!0}),m.ConsoleLogger=void 0;var i=function(){function c(v,w){this.debug=v,this.suppressErrorLogging=w}return c.prototype.prefixString=function(){return"</> quill-image-compress: "},Object.defineProperty(c.prototype,"log",{get:function(){return this.debug?console.log.bind(console,this.prefixString()):function(){}},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"error",{get:function(){return this.suppressErrorLogging?function(){}:console.error.bind(console,this.prefixString())},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"warn",{get:function(){return this.suppressErrorLogging?function(){}:console.warn.bind(console,this.prefixString())},enumerable:!1,configurable:!0}),c}();m.ConsoleLogger=i}])})})(P);var j=P.exports;const O=L(j);export{O as I};
